{% extends "partials/dashboard-template.html" %}
{% block extracss %} <link rel="stylesheet" href="{{ url_for('static', filename='dashboard/index/styles.css') }}">{% endblock extracss %}

{% block navbar %}
{% endblock navbar %}
{% block content %} 
{% if context.first_login %}
<div class="modal-overlay active" id="passwordModal">
  <div class="modal">
    <h2>Trocar Senha</h2>
    <p class="modal-info">
      Este é o seu primeiro acesso. Por motivos de segurança, é necessário redefinir sua senha.
    </p>
    <form action="{{url_for('reset_password_page')}}" method="POST" class="modal-form" onsubmit='authValidation(event)'>
      <div class="form-group">
        <label for="password">Nova Senha</label>
        <input type="password" id="password" name="password" placeholder='Informe sua senha'>
      </div>
      <div class="form-group">
        <label for="password-confirm">Confirmar Senha</label>
        <input type="password" id="password-confirm" name="password-confirm" placeholder='Confirme sua senha'>
      </div>
      <div class="error-messages"></div>
      <div class="modal-actions">
        <button type="submit" class="btn-submit">Salvar</button>
      </div>
    </form>
  </div>
</div>
{% elif context.no_user_info %}
  <div class="modal-overlay active" id="userInfoModal">
  <div class="modal">
    <h2>Informações do Usuário</h2>
    <p class="modal-info">
      Complete seu cadastro com suas informações pessoais.
    </p>
    <form method="POST" class="modal-form">
      <div class="form-group">
        <label for="full_name">Nome Completo</label>
        <input type="text" id="full_name" name="full_name" placeholder="Informe seu nome"
       value="{{ context.full_name_val or '' }}" required>
        <div class="error-messages" id="error-nome">
            {% if context.name_error %}
                <p>{{context.name_error}}</p>
            {% endif %}
        </div>
      </div>
      <div class="form-group">
        <label for="date_of_birth">Data de Nascimento</label>
        <input type="date" id="date_of_birth" name="date_of_birth"
       value="{{ context.date_val or '' }}" required>
        <div class="error-messages" id="error-date">
            {% if context.date_error %}
                <p>{{context.date_error}}</p>
            {% endif %}
        </div>
      </div>
      <div class="form-group">
        <label for="cpf">CPF</label>
        <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00"
       value="{{ context.cpf_val or '' }}" required>
        <div class="error-messages" id="error-cpf">
            {% if context.cpf_error %}
                <p>{{context.cpf_error}}</p>
            {% endif %}
        </div>
      </div>
      <div class="form-group">
        <label for="telephone_number">Telefone</label>
        <input type="tel" id="telephone_number" name="telephone_number"
       value="{{ context.telephone_val or '' }}" placeholder="(00) 00000-0000" required>
        <div class="error-messages" id="error-telephone">
          {% if context.phone_error %}
              <p>{{context.phone_error}}</p>
          {% endif %}
        </div>
      </div>
      <div class="form-group">
        <label for="position">Cargo</label>
        <select id="position" name="position" required>
            <option value="" disabled {% if not context.position_val %}selected{% endif %}>Selecione o cargo</option>
            <option value="Administrador" {% if context.position_val == "Administrador" %}selected{% endif %}>Administrador</option>
            <option value="Gerente" {% if context.position_val == "Gerente" %}selected{% endif %}>Gerente</option>
            <option value="Supervisor" {% if context.position_val == "Supervisor" %}selected{% endif %}>Supervisor</option>
            <option value="Funcionário" {% if context.position_val == "Funcionário" %}selected{% endif %}>Funcionário</option>
            <option value="Estagiário" {% if context.position_val == "Estagiário" %}selected{% endif %}>Estagiário</option>
        </select>
      </div>
      <div class="error-messages"></div>
      <div class="modal-actions">
        <button type="submit" class="btn-submit">Salvar</button>
      </div>
    </form>
  </div>
</div>
{% endif %}
{% endblock content %}   

{% block extracript %}
<script src="{{ url_for('static', filename='authpage/scripts.js') }}"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const errors = {
        {% if context.name_error %}"#error-nome": "{{ context.name_error }}",{% endif %}
        {% if context.date_error %}"#error-date": "{{ context.date_error }}",{% endif %}
        {% if context.cpf_error %}"#error-cpf": "{{ context.cpf_error }}",{% endif %}
        {% if context.telephone_error %}"#error-telephone": "{{ context.telephone_error }}",{% endif %}
    };

    for (const [selector, message] of Object.entries(errors)) {
        showErrorMessage(message, selector);
    }
});
</script>

<script src='{{ url_for('static', filename='dashboard/index/scripts.js') }}'></script>
{% endblock extracript %}
